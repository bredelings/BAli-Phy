<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>BAli-Phy User's Guide v2.1.0</title><link rel="stylesheet" href="docbook.css" type="text/css" /><meta name="generator" content="DocBook XSL Stylesheets V1.75.2" /></head><body><div xml:lang="en" class="article" title="BAli-Phy User's Guide v2.1.0" lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="id495746"></a><span class="application">BAli-Phy</span> User's Guide v2.1.0</h2></div><div><div class="author"><h3 class="author"><span class="firstname">Benjamin</span> <span class="surname">Redelings</span></h3></div></div></div><hr /></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="#pre-requisites">1. Pre-requisites</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id466413">1.1. Linux and UNIX</a></span></dt><dt><span class="sect2"><a href="#id458148">1.2. Windows</a></span></dt><dt><span class="sect2"><a href="#id464770">1.3. Mac OS X</a></span></dt></dl></dd><dt><span class="sect1"><a href="#compilation">2. Compiling <span class="application">BAli-Phy</span></a></span></dt><dd><dl><dt><span class="sect2"><a href="#id471147">2.1. Software requirements</a></span></dt><dt><span class="sect2"><a href="#id485534">2.2. Quick Start</a></span></dt><dt><span class="sect2"><a href="#id481403">2.3. Options to <span class="command"><strong>configure</strong></span></a></span></dt><dt><span class="sect2"><a href="#gitsource">2.4. Generating the <code class="filename">configure</code> script
	and Makefiles (<span class="application">git</span> only)</a></span></dt><dt><span class="sect2"><a href="#id481814">2.5. Installing when compiling from source</a></span></dt></dl></dd><dt><span class="sect1"><a href="#installation">3. Installation</a></span></dt><dd><dl><dt><span class="sect2"><a href="#software_req">3.1. Recommended Additional Software</a></span></dt><dt><span class="sect2"><a href="#id494519">3.2. Installing precompiled executables</a></span></dt><dt><span class="sect2"><a href="#id494566">3.3. Setting the PATH</a></span></dt></dl></dd><dt><span class="sect1"><a href="#running">4. Running the program</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id494739">4.1. Quick Start</a></span></dt><dt><span class="sect2"><a href="#id494836">4.2. Command line options</a></span></dt><dt><span class="sect2"><a href="#id494896">4.3. Multiple genes or data partitions</a></span></dt><dt><span class="sect2"><a href="#id498061">4.4. Option files (Scripts)</a></span></dt><dt><span class="sect2"><a href="#examples">4.5. Examples</a></span></dt></dl></dd><dt><span class="sect1"><a href="#command_line_options">5. Command-line options: An overview</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id498321">5.1. Usage</a></span></dt><dt><span class="sect2"><a href="#id498394">5.2. General options</a></span></dt><dt><span class="sect2"><a href="#id498496">5.3. MCMC options</a></span></dt><dt><span class="sect2"><a href="#id498564">5.4. Parameter options</a></span></dt><dt><span class="sect2"><a href="#id498665">5.5. Model options</a></span></dt></dl></dd><dt><span class="sect1"><a href="#input">6. Input</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id498767">6.1. Sequence formats</a></span></dt><dt><span class="sect2"><a href="#id498829">6.2. Is my data set too large?</a></span></dt></dl></dd><dt><span class="sect1"><a href="#output">7. Output</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id498917">7.1. Output directory</a></span></dt><dt><span class="sect2"><a href="#id498962">7.2. Output files</a></span></dt><dt><span class="sect2"><a href="#id499069">7.3. Summarizing the output</a></span></dt><dt><span class="sect2"><a href="#analysis">7.4. Summarizing the output - scripted</a></span></dt></dl></dd><dt><span class="sect1"><a href="#models">8. Models</a></span></dt><dd><dl><dt><span class="sect2"><a href="#subst_basic">8.1. Substitution models (Basic)</a></span></dt><dt><span class="sect2"><a href="#id500682">8.2. Indel models</a></span></dt><dt><span class="sect2"><a href="#id500691">8.3. Alignment constraints</a></span></dt></dl></dd><dt><span class="sect1"><a href="#subst_adv">9. Substitution Models (Advanced)</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id500831">9.1. Specifying a substitution model</a></span></dt><dt><span class="sect2"><a href="#id500869">9.2. CTMC Frequency models</a></span></dt><dt><span class="sect2"><a href="#id501095">9.3. Frequency Models</a></span></dt><dt><span class="sect2"><a href="#id501528">9.4. CTMC Mixture Models</a></span></dt><dt><span class="sect2"><a href="#id502272">9.5. Examples</a></span></dt></dl></dd><dt><span class="sect1"><a href="#mixing_and_convergence">10. Convergence and Mixing: Is it done yet?</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id502370">10.1. Convergence</a></span></dt><dt><span class="sect2"><a href="#id502430">10.2. Mixing</a></span></dt></dl></dd><dt><span class="sect1"><a href="#tuning_the_markov_chain">11. Tuning the Markov Chain</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id502493">11.1. Parameters</a></span></dt></dl></dd><dt><span class="sect1"><a href="#auxiliary_tools">12. Auxiliary tools</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id502764">12.1. alignment-find</a></span></dt><dt><span class="sect2"><a href="#id502779">12.2. alignment-draw</a></span></dt><dt><span class="sect2"><a href="#id502798">12.3. alignment-thin</a></span></dt><dt><span class="sect2"><a href="#id502818">12.4. alignment-chop-internal</a></span></dt><dt><span class="sect2"><a href="#id502836">12.5. alignment-info</a></span></dt><dt><span class="sect2"><a href="#id502859">12.6. alignment-indices</a></span></dt><dt><span class="sect2"><a href="#id502880">12.7. alignment-cat</a></span></dt><dt><span class="sect2"><a href="#id502900">12.8. trees-consensus</a></span></dt><dt><span class="sect2"><a href="#id502920">12.9. trees-bootstrap</a></span></dt><dt><span class="sect2"><a href="#id502959">12.10. trees-to-SRQ</a></span></dt></dl></dd><dt><span class="sect1"><a href="#FAQ">13. Frequently Asked Questions (FAQ)</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id503016">13.1. Running <span class="command"><strong>bali-phy</strong></span>.</a></span></dt><dt><span class="sect2"><a href="#id503055">13.2. Figuring out run-time errors</a></span></dt><dt><span class="sect2"><a href="#id503105">13.3. Stopping <span class="command"><strong>bali-phy</strong></span>.</a></span></dt><dt><span class="sect2"><a href="#id503200">13.4. Interpreting the results.</a></span></dt><dt><span class="sect2"><a href="#id503254">13.5. How do I...</a></span></dt></dl></dd></dl></div><div class="sect1" title="1. Pre-requisites"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="pre-requisites"></a>1. Pre-requisites</h2></div></div></div><p><span class="application">BAli-Phy</span> is developed
      primarily for on Linux, but also runs on Windows and Mac OS X.
      We typically run <span class="application">BAli-Phy</span> on Core2
      processors  with 8Gb of RAM. </p><p><span class="application">BAli-Phy</span> is a command-line
      application, not a graphical application.  The Windows and
      Macintosh version assume that you understand some
      UNIX commands, or at least are not intimidated by them.
    </p><div class="sect2" title="1.1. Linux and UNIX"><div class="titlepage"><div><div><h3 class="title"><a id="id466413"></a>1.1. Linux and UNIX</h3></div></div></div><p>On Linux, you should be able to install and
	run <span class="application">BAli-Phy</span> without any
	modification.  For other UNIX systems, you may need to
	compile <span class="application">BAli-Phy</span> before running it.</p></div><div class="sect2" title="1.2. Windows"><div class="titlepage"><div><div><h3 class="title"><a id="id458148"></a>1.2. Windows</h3></div></div></div><p>On Windows you must first install <a class="ulink" href="http://www.cygwin.com" target="_top">cygwin</a>.  Cygwin is a
	Unix/Linux command-line environment for Windows.  You can access the
	Cygwin command line (not the normal windows command line)
	through the Start menu.</p></div><div class="sect2" title="1.3. Mac OS X"><div class="titlepage"><div><div><h3 class="title"><a id="id464770"></a>1.3. Mac OS X</h3></div></div></div><p>We recommend Mac OS X version 10.4 (or higher).</p></div></div><div class="sect1" title="2. Compiling BAli-Phy"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="compilation"></a>2. Compiling <span class="application">BAli-Phy</span></h2></div></div></div><p>Most users will not need to
      compile <span class="application">BAli-Phy</span>, because they can
      use the precompiled
      executables from the official website for Linux, Mac, and
      Windows.  However, compiling <span class="application">BAli-Phy</span>
      is intended to be a relatively painless process.
    </p><p>Mote that in case you are compiling "live" source
      code that you checked out using GIT (and you probably
      aren't) then you need to follow the directions in <a class="xref" href="#gitsource" title="2.4. Generating the configure script and Makefiles (git only)">Section 2.4, “Generating the <code class="filename">configure</code> script
	and Makefiles (<span class="application">git</span> only)”</a> before you start compiling.
    </p><div class="sect2" title="2.1. Software requirements"><div class="titlepage"><div><div><h3 class="title"><a id="id471147"></a>2.1. Software requirements</h3></div></div></div><p>The following software packages are required for
	compiling BAli-Phy.
	
	</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p> The GNU C++ Compiler (<a class="ulink" href="http://gcc.gnu.org" target="_top">GCC</a>)
	      version 3.4 (or higher).
	    </p><div class="note" title="Mac OS X issues:" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Mac OS X issues:</h3><p>Apple's XCode software works, but only if you
		use OS X 10.4 (Tiger) or higher, and install XCode
		2.2 or higher.
	      </p></div></li><li class="listitem"><p>
	      <a class="ulink" href="http://www.gnu.org/software/make" target="_top">
		GNU make</a> version 3.80 (or higher).
	  </p></li><li class="listitem"><p> The GNU Scientific Library (<a class="ulink" href="http://sources.redhat.com/gsl/" target="_top">GSL</a>) version 1.8 (or higher).</p></li><li class="listitem"><p> The Cairo graphics library
	      (<a class="ulink" href="http://www.cairographics.org/" target="_top">Cairo</a>)
	      version 1.6 (or higher).  (Cairo is not strictly
	    necessary, but is a requirement for building the
	    tool <span class="application">draw-tree</span> that is used to
	    draw consensus trees.)</p></li></ul></div><p>
      </p></div><div class="sect2" title="2.2. Quick Start"><div class="titlepage"><div><div><h3 class="title"><a id="id485534"></a>2.2. Quick Start</h3></div></div></div><p>In order to compile the program on UNIX, first
	extract the source code archive, using a graphical archive
	manager, or the command-line tool <span class="command"><strong>tar</strong></span>:
	
	</p><pre class="screen"><code class="prompt">%</code> tar -zxf bali-phy-2.1.0.tgz</pre><p>
	Then create a <span class="emphasis"><em>separate</em></span> build directory, enter it, and run the
	configure command:

	</p><pre class="screen"><code class="prompt">%</code> mkdir build
<code class="prompt">%</code> cd build
<code class="prompt">%</code> ../bali-phy-2.1.0/configure</pre><p>
	
	If this command succeeds, then you can simply type

	</p><pre class="screen"><code class="prompt">%</code> make
<code class="prompt">%</code> make install</pre><p>

	to build and install <span class="command"><strong>bali-phy</strong></span> and its
	associated tools and install it in <code class="filename">/usr/local/</code>.
	(This requires the GNU version of <span class="command"><strong>make</strong></span>.)
	To customize the compilation and installation process, read the
	following sections on supplying arguments to the
	<span class="command"><strong>configure</strong></span> script.
      </p></div><div class="sect2" title="2.3. Options to configure"><div class="titlepage"><div><div><h3 class="title"><a id="id481403"></a>2.3. Options to <span class="command"><strong>configure</strong></span></h3></div></div></div><div class="sect3" title="2.3.1. Installing to a location besides /usr/local/"><div class="titlepage"><div><div><h4 class="title"><a id="install-prefix"></a>2.3.1. Installing to a location besides	<code class="filename">/usr/local/</code></h4></div></div></div><p>The configure script chooses to install
	  <span class="command"><strong>bali-phy</strong></span> in the directory
	  <code class="filename">/usr/local/</code> by default. We can install
	  executables to another directory <em class="replaceable"><code>dir</code></em>
	  by passing
	  <strong class="userinput"><code>--prefix=<em class="replaceable"><code>dir</code></em></code></strong>.
	  For example, in order to install
	  <span class="application">BAli-Phy</span> under
	  <code class="filename">~/local</code>, you can enter:

	  </p><pre class="screen"><code class="prompt">%</code> ../bali-phy-2.1.0/configure --prefix=$HOME/local</pre><p>
          This is recommended if you do not have permission to install
	  to <code class="filename">/usr/local/</code>.
	</p></div><div class="sect3" title="2.3.2. Specifying where to find libraries and header files (e.g. GSL)"><div class="titlepage"><div><div><h4 class="title"><a id="id481482"></a>2.3.2. Specifying where to find libraries and header files (e.g. GSL)</h4></div></div></div><p>You can instruct the compiler to look for include files
	  in directory <em class="replaceable"><code>dir</code></em> by passing
	  <strong class="userinput"><code>--with-extra-includes=<em class="replaceable"><code>dir</code></em></code></strong> to the <span class="command"><strong>configure</strong></span> script.
	</p><p>You can instruct the compiler to look for libraries
	  files in directory
	  <code class="filename"><em class="replaceable"><code>dir</code></em></code> by
	  passing
	  <strong class="userinput"><code>--with-extra-libs=<em class="replaceable"><code>dir</code></em></code></strong> to the <span class="command"><strong>configure</strong></span> script.  
	</p><p>For example, if your system has GSL installed in <code class="filename">/usr/local/</code>, then you might need to add "<strong class="userinput"><code>--with-extra-includes=/usr/local/include --with-extra-libs=/usr/local/lib</code></strong>" to the configure script arguments so that the compiler can find the GSL include files and libraries.</p></div><div class="sect3" title="2.3.3. Selecting a non-default C++ compiler"><div class="titlepage"><div><div><h4 class="title"><a id="id481551"></a>2.3.3. Selecting a non-default C++ compiler</h4></div></div></div><p>The default C++ compiler is <span class="command"><strong>g++</strong></span>.  On
	  some systems, <span class="command"><strong>g++</strong></span> invokes GCC version 3.3,
	  and the correct compiler is called something else, such as
	  <span class="command"><strong>g++-4.2</strong></span>.  To use
	  <span class="command"><strong>g++-4.2</strong></span> as the C++ compiler when compiling
	  <span class="application">BAli-Phy</span>, you would set the CXX
	  environment variable as follows:
	  </p><pre class="screen"><code class="prompt">%</code> ../bali-phy-2.1.0/configure CXX=g++-4.2</pre><p>
	</p></div><div class="sect3" title="2.3.4. Optimizing for a specific architecture"><div class="titlepage"><div><div><h4 class="title"><a id="id481600"></a>2.3.4. Optimizing for a specific architecture</h4></div></div></div><p>You can specify optimizing for a specific brand of CPU,
	  by specifying the <strong class="userinput"><code>CHIP</code></strong> variable to
	  <span class="command"><strong>configure</strong></span>, as follows:
	  </p><pre class="screen"><code class="prompt">%</code> ../bali-phy-2.1.0/configure CHIP=<em class="replaceable"><code>cpu</code></em></pre><p>
	  You can set CHIP to any of <strong class="userinput"><code>pentium3</code></strong>,
	  <strong class="userinput"><code>pentium4</code></strong>,
	  <strong class="userinput"><code>nocona</code></strong>, <strong class="userinput"><code>G3</code></strong>,
	  <strong class="userinput"><code>G4</code></strong>, or <strong class="userinput"><code>G5</code></strong>.  (On recent versions of GCC, you can set <strong class="userinput"><code>CHIP=native</code></strong> to auto-detect the type of CPU you have.  However, be aware that the resulting executables may not run on a different computer.)
	</p></div><div class="sect3" title="2.3.5. Statically linked executables"><div class="titlepage"><div><div><h4 class="title"><a id="id481676"></a>2.3.5. Statically linked executables</h4></div></div></div><p>Call <span class="command"><strong>configure</strong></span> with the flag
	  <strong class="userinput"><code>--enable-static</code></strong> to build static
	  executables.  Static executables will be able to run on other
	  computers with the with the same type of CPU but slightly
	  different versions of the operating system. 
	</p></div><div class="sect3" title="2.3.6. Example"><div class="titlepage"><div><div><h4 class="title"><a id="id481701"></a>2.3.6. Example</h4></div></div></div><p>
          All these options to <span class="command"><strong>configure</strong></span> can be
	  combined, as follows:
	  </p><pre class="screen"><code class="prompt">%</code> ../bali-phy-2.1.0/configure --prefix=$HOME/local --enable-static CXX=g++-4.4 CHIP=pentium4</pre><p>
          This example uses <span class="command"><strong>g++-4.4</strong></span> to build a
	  pentium4-optimized version of <span class="command"><strong>bali-phy</strong></span> with
	  static linkage.
	</p></div></div><div class="sect2" title="2.4. Generating the configure script and Makefiles (git only)"><div class="titlepage"><div><div><h3 class="title"><a id="gitsource"></a>2.4. Generating the <code class="filename">configure</code> script
	and Makefiles (<span class="application">git</span> only)</h3></div></div></div><p>Skip this step unless you are compiling a
	snapshot of the source code that you checked out using
	GIT. If you downloaded an official tar.gz archive of the
	source from the website, then it already includes these files.
      </p><p>To generate these files, you need automake 1.8 (or higher)
	and autoconf 2.59 (or higher).  Run these commands in the top level
	directory of the repository that you checked out.</p><pre class="screen"><code class="prompt">%</code> autoheader
<code class="prompt">%</code> aclocal -I m4
<code class="prompt">%</code> automake -a
<code class="prompt">%</code> autoconf</pre><p>
        If your system has multiple versions of automake, then you may
	have to type e.g. <strong class="userinput"><code>automake-1.11 -a</code></strong> and
	<strong class="userinput"><code>aclocal-1.11</code></strong> instead in order to specify which
	version to use.
      </p></div><div class="sect2" title="2.5. Installing when compiling from source"><div class="titlepage"><div><div><h3 class="title"><a id="id481814"></a>2.5. Installing when compiling from source</h3></div></div></div><p>
	After compiling <span class="application">BAli-Phy</span>, you can
	simply type <span class="command"><strong>make install</strong></span>.  This will copy the
	compiled executables to the installation directory (See <a class="xref" href="#install-prefix" title="2.3.1. Installing to a location besides /usr/local/">Section 2.3.1, “Installing to a location besides	<code class="filename">/usr/local/</code>”</a>).
      </p></div></div><div class="sect1" title="3. Installation"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="installation"></a>3. Installation</h2></div></div></div><div class="sect2" title="3.1. Recommended Additional Software"><div class="titlepage"><div><div><h3 class="title"><a id="software_req"></a>3.1. Recommended Additional Software</h3></div></div></div><p>We recommend that you install some additional software in order
	to graphically view the simple text files
	that <span class="application">BALi-Phy</span> outputs:

	</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><span class="application">Tracer</span> - to
	      analyze MCMC diagnostics 
	      (<a class="ulink" href="http://tree.bio.ed.ac.uk/software/tracer/" target="_top">Tracer</a>) 
	  </p></li><li class="listitem"><p>PERL - to script an analysis
	      of <span class="application">BALi-Phy</span> output files</p></li><li class="listitem"><p>The plotting program
	      <span class="application">gnuplot</span> (<a class="ulink" href="http://www.gnuplot.info/" target="_top">gnuplot</a>) - to script an analysis
	      of <span class="application">BALi-Phy</span> output files</p></li><li class="listitem"><p>Mozilla or Mozilla/Firefox - to view the math in
	      the XHTML documentation. (<a class="ulink" href="http://www.mozilla.org/products/firefox/" target="_top">Firefox</a>)</p></li></ul></div><p>
      </p><p>On Mac OS X, PERL should already be installed, and you should be
	able to install <span class="application">gnuplot</span>
	using <a class="ulink" href="http://www.macports.org" target="_top">MacPorts</a>.
	On Windows, you can install PERL and gnuplot using
	the <a class="ulink" href="http://www.cygwin.com" target="_top">Cygwin</a>
	installer. On Linux, use your distribution's package manager.
      </p><p>We additionally recommend the program <a class="ulink" href="http://pbil.univ-lyon1.fr/software/seaview.html" target="_top">seaview</a> to graphically view sequence alignments, and the program <a class="ulink" href="http://tree.bio.ed.ac.uk/software/figtree/" target="_top">FigTree</a> to graphically view phylogenies.</p></div><div class="sect2" title="3.2. Installing precompiled executables"><div class="titlepage"><div><div><h3 class="title"><a id="id494519"></a>3.2. Installing precompiled executables</h3></div></div></div><p>To install pre-compiled executables, simply extract the
	compressed archive in the directory of your choice.  If you have
	root access you might extract in
	<code class="filename">/usr/local</code>; if not, you might make a
	directory <code class="filename">~/local</code> in your home directory
	and extract there.
      </p><p>You can extract the compressed archive on the command line
	using the <span class="command"><strong>tar</strong></span> command:
	</p><pre class="screen"><code class="prompt">%</code> tar -zxf bali-phy-<em class="replaceable"><code>version</code></em>.tgz</pre><p>
      </p></div><div class="sect2" title="3.3. Setting the PATH"><div class="titlepage"><div><div><h3 class="title"><a id="id494566"></a>3.3. Setting the PATH</h3></div></div></div><p>
	If you installed <span class="application">BAli-Phy</span> to the directory
	<code class="filename">/usr/local/</code>, then you can run
	bali-phy by typing <strong class="userinput"><code>/usr/local/bin/bali-phy</code></strong>.
	However, it would be much nicer to simply type
	<strong class="userinput"><code>bali-phy</code></strong> and let the computer find the
	executable for you.  This can be achieved by putting the directory
	that contains the <code class="filename">bali-phy</code> executables into
	your "path".  (The directory that contains the executables will be
	<code class="filename">/usr/local/bin</code> if you extracted the bali-phy
	archive to the directory <code class="filename">/usr/local</code>, but will
	be somewhere else if you extracted the bali-phy archive somewhere else.)
      </p><p>
	The "path" is a colon-separated list of directories that is
	searched to find program names that you type.  It is stored in a
	variable called PATH.  You can examine it the current value of
	this variable by 
	</p><pre class="screen"><code class="prompt">%</code> echo $PATH</pre><p>
	We will assume that you extracted the bali-phy archive in
	<code class="filename">/usr/local</code> and so you want to add
	<code class="filename">/usr/local/bin</code> to your PATH.  The commands
	for doing depend on what "shell" you are using.  Type
	<strong class="userinput"><code>echo $SHELL</code></strong> to find out.
      </p><p>If your shell is <span class="command"><strong>sh</strong></span> or
	<span class="command"><strong>bash</strong></span> then the command looks like this: 
	</p><pre class="screen"><code class="prompt">%</code> PATH=/usr/local/bin:$PATH</pre><p>
	If your shell is <span class="command"><strong>csh</strong></span> or
	<span class="command"><strong>tcsh</strong></span>, then the command looks like this:
	</p><pre class="screen"><code class="prompt">%</code> setenv PATH /usr/local/bin:$PATH</pre><p>
	Unfortunately, the effects of this will affect only the window you
	are typing in, and will vanish when you reboot.  You can put these
	command into the files <code class="filename">.profile</code> (for the
	Bourne shell <span class="command"><strong>sh</strong></span>), 
	<code class="filename">.bash_profile</code> (for BASH), or
	<code class="filename">.login</code> (for tcsh).  However, those details are
	beyond the scope of this document.
      </p></div></div><div class="sect1" title="4. Running the program"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="running"></a>4. Running the program</h2></div></div></div><div class="sect2" title="4.1. Quick Start"><div class="titlepage"><div><div><h3 class="title"><a id="id494739"></a>4.1. Quick Start</h3></div></div></div><p>The simplest way to run <span class="command"><strong>BAli-Phy</strong></span> is
	to type all the arguments on the command line:

	</p><pre class="screen"><code class="prompt">%</code> bali-phy <em class="replaceable"><code>sequence-file</code></em></pre><p>

	Here <em class="replaceable"><code>sequence-file</code></em> is a FastA or PHYLIP
	file containing the sequences you wish to analyze.  The filename should end
	in <strong class="userinput"><code>.fasta</code></strong> or <strong class="userinput"><code>.phy</code></strong> to
	indicate which format it is using.</p><p>In this simple example, <span class="command"><strong>bali-phy</strong></span> automatically detects whether <em class="replaceable"><code>sequence-file</code></em> contains DNA, RNA, or Amino-Acids and uses default values for several command line options.  Thus, if <em class="replaceable"><code>sequence-file</code></em> contains DNA, then this is equivalent to the more verbose command line
	</p><pre class="screen"><code class="prompt">%</code> bali-phy <em class="replaceable"><code>sequence-file</code></em> --alphabet DNA --smodel TN --imodel RS07 --iterations=100000</pre><p>  Here the substitution model is Tamura-Nei, the insertion/deletion model is RS07, and the number of iterations is 100,000.  If <em class="replaceable"><code>sequence-file</code></em> contains amino acids, then the defaults will be:</p><pre class="screen"><code class="prompt">%</code> bali-phy <em class="replaceable"><code>sequence-file</code></em> --alphabet Amino-Acids --smodel LG --imodel RS07 --iterations=100000</pre><p> 
      </p></div><div class="sect2" title="4.2. Command line options"><div class="titlepage"><div><div><h3 class="title"><a id="id494836"></a>4.2. Command line options</h3></div></div></div><p>You can specify more a more complex substitution model as follows:
	</p><pre class="screen"><code class="prompt">%</code> bali-phy <em class="replaceable"><code>sequence-file</code></em> --smodel WAG+gamma+INV</pre><p>
	You may specify an indel model of <strong class="userinput"><code>none</code></strong> to fix the alignment and ignore information in shared insertions or deletions.
  	</p><pre class="screen"><code class="prompt">%</code> bali-phy <em class="replaceable"><code>sequence-file</code></em> --imodel none</pre><p>
	If you desire to use a codon model, you must specify the alphabet:
	</p><pre class="screen"><code class="prompt">%</code> bali-phy <em class="replaceable"><code>sequence-file</code></em> --smodel M0 --alphabet Codons</pre><p>
      </p></div><div class="sect2" title="4.3. Multiple genes or data partitions"><div class="titlepage"><div><div><h3 class="title"><a id="id494896"></a>4.3. Multiple genes or data partitions</h3></div></div></div><p>You may analyze multiple genes by putting each one it its own data partition:
	</p><pre class="screen"><code class="prompt">%</code> bali-phy <em class="replaceable"><code>sequence-file1</code></em> <em class="replaceable"><code>sequence-file2</code></em></pre><p>
	You should put the data from the first gene in <em class="replaceable"><code>sequence-file1</code></em> and the second gene
	in <em class="replaceable"><code>sequence-file2</code></em>.  In this scenario, both genes share the same tree, but their alignment varies independently.  Furthermore, the branch lengths for each gene are scaled by an independent factor.  By default, each partition will have its own default alphabet, substitution model, insertion/deletion model, and tree length.    
      </p><p>You can select partition-specific values for 5 options: <strong class="userinput"><code>--smodel</code></strong>, <strong class="userinput"><code>--imodel</code></strong>, <strong class="userinput"><code>--alphabet</code></strong>, <strong class="userinput"><code>--same-scale</code></strong>, and <strong class="userinput"><code>--align-constraint</code></strong>.  For example, to specify different substitution models but the same alphabet:
</p><pre class="screen"><code class="prompt">%</code> bali-phy <em class="replaceable"><code>sequence-file1</code></em> <em class="replaceable"><code>sequence-file2</code></em> --smodel 1:TN --smodel 2:GTR --alphabet 1,2:DNA</pre><p>
You can fix the alignment and ignore insertion/deletion information in one partition, while allowing the alignment to vary and using insertion/deletion information in another partition:
</p><pre class="screen"><code class="prompt">%</code> bali-phy <em class="replaceable"><code>sequence-file1</code></em> <em class="replaceable"><code>sequence-file2</code></em> --imodel 1:RS07 --imodel 2:none</pre><p>
You can also specify that two partitions share a single copy of a single substitution model or indel model.  This reduces the number of parameters and pools information between the partitions:
</p><pre class="screen"><code class="prompt">%</code> bali-phy <em class="replaceable"><code>sequence-file1</code></em> <em class="replaceable"><code>sequence-file2</code></em> --smodel 1,2:TN --imodel 1,2:RS07</pre><p>
However, if you do not specify the partition numbers, then each partition will recieve an independent copy of the model, and will not share parameter values:
</p><pre class="screen"><code class="prompt">%</code> bali-phy <em class="replaceable"><code>sequence-file1</code></em> <em class="replaceable"><code>sequence-file2</code></em> --smodel TN --imodel RS07</pre><p>
By default each partition has a separate scale, but you can force groups of partitions to share a scale. The name of the groups for the scale are not currently used, but may be used in later versions of the software:
</p><pre class="screen"><code class="prompt">%</code> bali-phy <em class="replaceable"><code>sequence-file1</code></em> <em class="replaceable"><code>sequence-file2</code></em> --smodel 1:TN --smodel 2:GTR --same-scale 1,2:groupname</pre><p>
Finally, you may specify the option <strong class="userinput"><code>--traditional</code></strong>, or its short form <strong class="userinput"><code>-t</code></strong>.  This is the same as <strong class="userinput"><code>--imodel none</code></strong> and affects all partitions:
</p><pre class="screen"><code class="prompt">%</code> bali-phy <em class="replaceable"><code>sequence-file1</code></em> <em class="replaceable"><code>sequence-file2</code></em> --smodel 1:TN --smodel 2:GTR -t</pre><p>
      </p></div><div class="sect2" title="4.4. Option files (Scripts)"><div class="titlepage"><div><div><h3 class="title"><a id="id498061"></a>4.4. Option files (Scripts)</h3></div></div></div><p>
	In addition to using the command line, you may also specify
	options in a file. Using an option file can be more convenient
	if you are going to run the same analysis many times, or if
	the number of options is large. Furthermore, the option file
	may contain comments and blank lines.  Option files are a good
	way, and is a good way to record what options you used in an
	analysis. 
      </p><p>
	  An option file is specified with the command line option "<strong class="userinput"><code>--config
	    <em class="replaceable"><code>file</code></em></code></strong>". If values
	    for an option are given both on the the command line and
	    in an option file, then the command line value overrides
	    the value in the option file. 
	</p><div class="sect3" title="4.4.1. Syntax"><div class="titlepage"><div><div><h4 class="title"><a id="id498086"></a>4.4.1. Syntax</h4></div></div></div><p>Option files use the same option names as the command
	line.  However, the syntax is different:  each option is given
	  on its own line using the syntax "<strong class="userinput"><code>option =
	    value</code></strong>" instead of the syntax "<strong class="userinput"><code>--option
	    value</code></strong>".  If the option has no value then it is
	  given using the syntax  "<strong class="userinput"><code>option =
	    option</code></strong>".  
	</p></div><div class="sect3" title="4.4.2. Example"><div class="titlepage"><div><div><h4 class="title"><a id="id498113"></a>4.4.2. Example</h4></div></div></div><p>
	  For example, consider the following
	  option file:
	  </p><pre class="programlisting">#select a data set to analyze
align = examples/EF-Tu/5d.fasta

#select an substitution model
smodel = log-normal+INV

#fix the alignment and do not model indels
traditional = traditional
	  </pre><p>
          The first option, <strong class="userinput"><code>align</code></strong> is the name of
	  the sequence file, which has no name on the command line.
	  Lines that begin with # are comments, and blank lines are
	  ignored.  The option <strong class="userinput"><code>--traditional</code></strong> uses
	  the option name as the value, because it does not take a
	  value.  Thus, this configuration file corresponds to the
	  command line
	  </p><pre class="screen"><code class="prompt">%</code>bali-phy examples/EF-Tu/5d.fasta --smodel log-normal+INV --traditional</pre><p>
	</p></div><div class="sect3" title="4.4.3. The configuration file"><div class="titlepage"><div><div><h4 class="title"><a id="id498153"></a>4.4.3. The configuration file</h4></div></div></div><p>
	  The file <code class="filename">~/.bali-phy</code> is a special
	  option file called the <span class="emphasis"><em>configuration
	    file.</em></span>  If it exists, it is always loaded.
	  Options given on the command line or an option file 
	  override values given in <code class="filename">~/.bali-phy</code>. 
	</p></div></div><div class="sect2" title="4.5. Examples"><div class="titlepage"><div><div><h3 class="title"><a id="examples"></a>4.5. Examples</h3></div></div></div><p>Here are some examples which demonstrate how to run
      <span class="application">BAli-Phy</span>.  In order to run these
      examples, you must find the <code class="filename">examples/</code>
      directory which contains the example files.  Typically, the
      <code class="filename">examples/</code> directory will be found at
      <code class="filename"><em class="replaceable"><code>prefix</code></em>/share/bali-phy/examples/</code>
      if you installed <span class="application">bali-phy</span> in directory
      <em class="replaceable"><code>prefix</code></em>.
    </p><p>Also note that <span class="command"><strong>bali-phy</strong></span>
      does <span class="emphasis"><em>not</em></span> run until it
      is "finished", but continues to gather samples until the user
      stops it.  Thus, it is useful to continually examine the output
      files while the program is running.
    </p><div class="example"><a id="id498236"></a><p class="title"><b>Example 1. No frills</b></p><div class="example-contents"><p>Here we analyze the EF-Tu 5-taxon data set provided with
	the software.</p><pre class="screen"> <code class="prompt">%</code> bali-phy <em class="replaceable"><code>somewhere</code></em>/examples/EF-Tu/5d.fasta</pre></div></div><br class="example-break" /><div class="example"><a id="id498260"></a><p class="title"><b>Example 2. Multiple-Rate Substitution Model</b></p><div class="example-contents"><p>We now modify the previous example by changing the
	substitution model to allow log-normal-distributed rate variation and
	invariant sites.  The amount of rate variation and the fraction of
	invariant sites are estimated</p><pre class="screen"> <code class="prompt">%</code> bali-phy <em class="replaceable"><code>somewhere</code></em>/examples/EF-Tu/5d.fasta --smodel log-normal+INV --randomize-alignment</pre></div></div><br class="example-break" /><div class="example"><a id="id498285"></a><p class="title"><b>Example 3. Fixed alignment</b></p><div class="example-contents"><p>Here we use the 5S rRNA 5-taxon data set provided with
	the software.  The alignment is fixed and the traditional
	likelihood model is used, making indels non-informative.  In
	addition, the transition kernel which samples nucleotide frequencies
	is disabled, thus fixing the nucleotide frequencies to empirical values
	estimated from the input sequences.
      </p><pre class="screen"> <code class="prompt">%</code> bali-phy <em class="replaceable"><code>somewhere</code></em>/examples/5S-rRNA/5d.fasta --smodel pi=constant --traditional</pre></div></div><br class="example-break" /></div></div><div class="sect1" title="5. Command-line options: An overview"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="command_line_options"></a>5. Command-line options: An overview</h2></div></div></div><div class="sect2" title="5.1. Usage"><div class="titlepage"><div><div><h3 class="title"><a id="id498321"></a>5.1. Usage</h3></div></div></div><p>The syntax for <span class="command"><strong>bali-phy</strong></span> is:</p><div class="cmdsynopsis"><p><code class="command">bali-phy</code>  {<em class="replaceable"><code>sequence-file1</code></em>} [<em class="replaceable"><code>sequence-file2</code></em> <em class="replaceable"><code>sequence-file3</code></em>...] [OPTIONS]</p></div><p>The sequence file is the only required argument.  It can
	be either a FastA (*.fasta) file or a PHYLIP (*.phy) file.  The
	file must end in one of these two suffixes or
	<span class="application">BAli-Phy</span> won't know how to read
	it.</p><p>The optional arguments are described below.  They can also
	be found by typing <strong class="userinput"><code>bali-phy --help</code></strong> on the
	command line.
      </p></div><div class="sect2" title="5.2. General options"><div class="titlepage"><div><div><h3 class="title"><a id="id498394"></a>5.2. General options</h3></div></div></div><div class="variablelist"><table border="0"><col align="left" valign="top" /><tbody><tr><td><p><span class="term"><code class="option">-h, --help</code></span></p></td><td><p>Show help message.</p></td></tr><tr><td><p><span class="term"><code class="option">-v, --version</code></span></p></td><td><p>Show version information.</p></td></tr><tr><td><p><span class="term"><code class="option">-c <em class="replaceable"><code>file</code></em>, --config <em class="replaceable"><code>file</code></em></code></span></p></td><td><p>Option file to read.</p></td></tr><tr><td><p><span class="term"><code class="option">--show-only</code></span></p></td><td><p>Analyze initial values and exit.</p></td></tr><tr><td><p><span class="term"><code class="option">--seed <em class="replaceable"><code>seed</code></em></code></span></p></td><td><p>Use the specified seed to initialize the
	      random number generator.</p></td></tr><tr><td><p><span class="term"><code class="option">--name <em class="replaceable"><code>string</code></em></code></span></p></td><td><p>Specify the name for the analysis directory.</p></td></tr><tr><td><p><span class="term"><code class="option">-t, --traditional</code></span></p></td><td><p>Fix the alignment and don't model indels.</p></td></tr></tbody></table></div></div><div class="sect2" title="5.3. MCMC options"><div class="titlepage"><div><div><h3 class="title"><a id="id498496"></a>5.3. MCMC options</h3></div></div></div><div class="variablelist"><table border="0"><col align="left" valign="top" /><tbody><tr><td><p><span class="term"><code class="option">--iterations <em class="replaceable"><code>number=100000</code></em></code></span></p></td><td><p>Specify the number of iterations to run.</p></td></tr><tr><td><p><span class="term"><code class="option">--subsample <em class="replaceable"><code>factor=1</code></em></code></span></p></td><td><p>Specify a factor by which to subsample.</p></td></tr><tr><td><p><span class="term"><code class="option">--enable <em class="replaceable"><code>move</code></em></code></span></p></td><td><p>Enable a comma-separated list of transition kernels.</p></td></tr><tr><td><p><span class="term"><code class="option">--disable <em class="replaceable"><code>move</code></em></code></span></p></td><td><p>Disable a comma-separated list of transition kernels.</p></td></tr></tbody></table></div></div><div class="sect2" title="5.4. Parameter options"><div class="titlepage"><div><div><h3 class="title"><a id="id498564"></a>5.4. Parameter options</h3></div></div></div><div class="variablelist"><table border="0"><col align="left" valign="top" /><tbody><tr><td><p><span class="term"><code class="option">--randomize-alignment</code></span></p></td><td><p>Randomly re-align sequences before use.</p></td></tr><tr><td><p><span class="term"><code class="option">--tree <em class="replaceable"><code>file</code></em></code></span></p></td><td><p>Specify file with initial tree.</p></td></tr><tr><td><p><span class="term"><code class="option">--set <em class="replaceable"><code>parameter=value</code></em></code></span></p></td><td><p>Specify initial value of <em class="replaceable"><code>parameter</code></em>.</p></td></tr><tr><td><p><span class="term"><code class="option">--fix <em class="replaceable"><code>parameter[=value]</code></em></code></span></p></td><td><p>Mark <em class="replaceable"><code>parameter</code></em> fixed, and optionally specify a value.</p></td></tr><tr><td><p><span class="term"><code class="option">--unfix <em class="replaceable"><code>parameter[=value]</code></em></code></span></p></td><td><p>Mark <em class="replaceable"><code>parameter</code></em> not fixed, and optionally specify an initial value.</p></td></tr><tr><td><p><span class="term"><code class="option">--frequencies <em class="replaceable"><code>frequencies</code></em></code></span></p></td><td><p>Specify initial frequencies: 'uniform','nucleotides', or a comma-separated list of frequencies.</p></td></tr></tbody></table></div></div><div class="sect2" title="5.5. Model options"><div class="titlepage"><div><div><h3 class="title"><a id="id498665"></a>5.5. Model options</h3></div></div></div><div class="variablelist"><table border="0"><col align="left" valign="top" /><tbody><tr><td><p><span class="term"><code class="option">--alphabet <em class="replaceable"><code>name</code></em></code></span></p></td><td><p>Specify the alphabet: DNA, RNA, Amino-Acids, Amino-Acids+stop, Triplets, Codons, or Codons + stop.</p></td></tr><tr><td><p><span class="term"><code class="option">--smodel <em class="replaceable"><code>name</code></em></code></span></p></td><td><p>Specify the substitution model.</p></td></tr><tr><td><p><span class="term"><code class="option">--imodel <em class="replaceable"><code>name</code></em></code></span></p></td><td><p>Specify the indel model.</p></td></tr><tr><td><p><span class="term"><code class="option">--branch-prior <em class="replaceable"><code>name</code></em></code></span></p></td><td><p>Exponential or Gamma.</p></td></tr><tr><td><p><span class="term"><code class="option">--same-scale <em class="replaceable"><code>specification</code></em></code></span></p></td><td><p>Which partitions have the same scale?</p></td></tr><tr><td><p><span class="term"><code class="option">--align-constraint <em class="replaceable"><code>filename</code></em></code></span></p></td><td><p>File with alignment constraints.</p></td></tr></tbody></table></div></div></div><div class="sect1" title="6. Input"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="input"></a>6. Input</h2></div></div></div><div class="sect2" title="6.1. Sequence formats"><div class="titlepage"><div><div><h3 class="title"><a id="id498767"></a>6.1. Sequence formats</h3></div></div></div><p><span class="application">BAli-Phy</span> can read in sequences
	and alignments in both FastA and PHYLIP formats.  Filenames for
	FastA files should end in <strong class="userinput"><code>.fasta</code></strong>,
	<strong class="userinput"><code>.mpfa</code></strong>, <strong class="userinput"><code>.fna</code></strong>,
	<strong class="userinput"><code>.fas</code></strong>, <strong class="userinput"><code>.fsa</code></strong>, or
	<strong class="userinput"><code>.fa</code></strong>.  Filenames for PHYLIP files should
	end in <strong class="userinput"><code>.phy</code></strong>.  If one of these extensions
	is not used, then <span class="application">BAli-Phy</span> will
	attempt to guess which format is being used.
      </p><p>
	Note that blank lines are now allowed in FastA files in version 2.0.1 and later.
      </p></div><div class="sect2" title="6.2. Is my data set too large?"><div class="titlepage"><div><div><h3 class="title"><a id="id498829"></a>6.2. Is my data set too large?</h3></div></div></div><p>Large data sets run more slowly than small data
	sets. We recommend a conservative starting point with few taxa
	and short sequence lengths.  You can then increase the size of
	your data set until a balance between speed and size is
	reached.</p><p>The number of samples that you need depends on whether you
	are primarily interested in obtaining a point estimate or in
	obtaining detailed measures of confidence and uncertainty.  For
	detailed measures of confidence and uncertainty you should
	obtain a minimum of 10,000 samples after the Markov chain
	converges.  For an estimate, you don't need very many samples
	after convergence.  (But you may need many samples to be sure
	that you've converged!)
      </p><div class="sect3" title="6.2.1. Too many taxa?"><div class="titlepage"><div><div><h4 class="title"><a id="id498846"></a>6.2.1. Too many taxa?</h4></div></div></div><p><span class="application">BAli-Phy</span> is quite CPU
	  intensive, and so we recommend using 12 or fewer taxa in order
	  to limit the time required to accumulate enough MCMC samples.
	  We note that many phylogenetic hypotheses can be reduced to
	  hypotheses concerning only four taxa.  We recommend initially
	  removing as many taxa as possible from your data set.  You can
	  then add taxa back into the data set after you have determined
	  how much this will increase the duration of the run.</p></div><div class="sect3" title="6.2.2. Sequences too long?"><div class="titlepage"><div><div><h4 class="title"><a id="id498864"></a>6.2.2. Sequences too long?</h4></div></div></div><p>Aligning sequences takes <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>O</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mi>L</mml:mi> <mml:mn>2 </mml:mn></mml:msup><mml:mo>)</mml:mo></mml:math> time and RAM, where 
	  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>L</mml:mi></mml:math> represents the sequence length.  Thus, doubling the length
	  of the input sequences increases RAM requirements and run
	  time by a factor of 4.  Therefore sequence lengths beyond
	  750 letters may prove impractical due to limited RAM or the
	  speed of the calculation.   For protein sequences,
	  we recommend coding the sequences in terms of amino acids or
	  codons, rather than nucleotides.</p><p>However, you might try to see how long you can make your
	  sequences before the attempt becomes impractical.</p></div></div></div><div class="sect1" title="7. Output"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="output"></a>7. Output</h2></div></div></div><div class="sect2" title="7.1. Output directory"><div class="titlepage"><div><div><h3 class="title"><a id="id498917"></a>7.1. Output directory</h3></div></div></div><p><span class="application">BAli-Phy</span> creates a new
	directory to store its output files each time it is run.  By default, the
	directory name is the name of the sequence file, with a number
	added on the end to make it unique. <span class="application">BAli-Phy</span>
	first checks  if there is already a directory called
	<code class="filename"><em class="replaceable"><code>file</code></em>-1/</code>, and then moves on to
	<code class="filename"><em class="replaceable"><code>file</code></em>-2/</code>, etc. until it finds an
	unused directory name.</p><p>You can specify a different name to use instead of the
	sequence-file name by using the <strong class="userinput"><code>--name</code></strong> option.</p></div><div class="sect2" title="7.2. Output files"><div class="titlepage"><div><div><h3 class="title"><a id="id498962"></a>7.2. Output files</h3></div></div></div><p><span class="application">BAli-Phy</span> produces the following output
	files inside the directory that it creates:</p><div class="variablelist"><table border="0"><col align="left" valign="top" /><tbody><tr><td><p><span class="term">C1.out</span></p></td><td><p>Iteration numbers, probabilities, success probabilities for transition kernels, etc..</p></td></tr><tr><td><p><span class="term">C1.P<em class="replaceable"><code>p</code></em>.fastas</span></p></td><td><p>Sampled alignments for partition <em class="replaceable"><code>p</code></em></p></td></tr><tr><td><p><span class="term">C1.err</span></p></td><td><p>You can ignore this file.</p></td></tr><tr><td><p><span class="term">C1.MAP</span></p></td><td><p>Successive estimates of the MAP point, if you have
	      only one partition.</p></td></tr><tr><td><p><span class="term">C1.p</span></p></td><td><p>Scalar parameters: indel and substitution parameters, etc.</p></td></tr><tr><td><p><span class="term">C1.trees</span></p></td><td><p>Tree samples</p></td></tr></tbody></table></div><p>For the last two files, each line in these files corresponds to one iteration.</p></div><div class="sect2" title="7.3. Summarizing the output"><div class="titlepage"><div><div><h3 class="title"><a id="id499069"></a>7.3. Summarizing the output</h3></div></div></div><div class="sect3" title="7.3.1. Finding the consensus tree (C1.trees)"><div class="titlepage"><div><div><h4 class="title"><a id="id499074"></a>7.3.1. Finding the consensus tree (<code class="filename">C1.trees</code>)</h4></div></div></div><p>
</p><pre class="screen"><code class="prompt">%</code> trees-consensus --skip=<em class="replaceable"><code>burnin</code></em> C1.trees --consensus-PP 0.5:c50.PP.tree</pre><p>	
The program <a class="ulink" href="http://tree.bio.ed.ac.uk/software/figtree/" target="_top">FigTree</a> allows you to view the consensus tree graphically.
</p></div><div class="sect3" title="7.3.2. Checking topology convergence (C1.trees)"><div class="titlepage"><div><div><h4 class="title"><a id="id499106"></a>7.3.2. Checking topology convergence (<code class="filename">C1.trees</code>)</h4></div></div></div><p>
</p><pre class="screen"><code class="prompt">%</code> trees-bootstrap <em class="replaceable"><code>dir1</code></em>/C1.trees <em class="replaceable"><code>dir2</code></em>/C1.trees</pre><p>	
This command computes the effective sample size for the posterior probability of each split.  It also computes the Average Standard Deviation of Split Frequencies (ASDSF) between two or more independent runs.
</p></div><div class="sect3" title="7.3.3. Summarizing numerical parameters (C1.p)"><div class="titlepage"><div><div><h4 class="title"><a id="id499139"></a>7.3.3. Summarizing numerical parameters (<code class="filename">C1.p</code>)</h4></div></div></div><p>
</p><pre class="screen"><code class="prompt">%</code> statreport C1.p &gt; Report </pre><p>	
The program <a class="ulink" href="http://tree.bio.ed.ac.uk/software/tracer/" target="_top">Tracer</a> allows you to view the same summaries graphically.
</p></div><div class="sect3" title="7.3.4. Computing an alignment using Posterior Decoding (C1.Pp.fastas)"><div class="titlepage"><div><div><h4 class="title"><a id="id499168"></a>7.3.4. Computing an alignment using Posterior Decoding (<code class="filename">C1.P<em class="replaceable"><code>p</code></em>.fastas</code>)</h4></div></div></div><p>
</p><pre class="screen"><code class="prompt">%</code> cut-range --skip=<em class="replaceable"><code>burn-in</code></em> C1.P<em class="replaceable"><code>p</code></em>.fastas | alignments-max &gt; P<em class="replaceable"><code>p</code></em>-max.fasta</pre><p>
You can use the program <a class="ulink" href="http://pbil.univ-lyon1.fr/software/seaview.html" target="_top">seaview</a> to view the alignment graphically.
</p></div><div class="sect3" title="7.3.5. Find the alignment from the maximum a posterior (MAP) point (C1.MAP)"><div class="titlepage"><div><div><h4 class="title"><a id="id499210"></a>7.3.5. Find the alignment from the maximum a posterior (MAP) point (<code class="filename">C1.MAP</code>)</h4></div></div></div><pre class="screen"><code class="prompt">%</code> alignment-find C1.P<em class="replaceable"><code>p</code></em>.fastas &gt; P<em class="replaceable"><code>p</code></em>-MAP.fasta</pre></div><div class="sect3" title="7.3.6. Create an Au (Alignment Uncertainty) plot (C1.Pp.fastas)"><div class="titlepage"><div><div><h4 class="title"><a id="id499238"></a>7.3.6. Create an Au (Alignment Uncertainty) plot (<code class="filename">C1.P<em class="replaceable"><code>p</code></em>.fastas</code>)</h4></div></div></div><pre class="screen"><code class="prompt">%</code> cut-range --skip=<em class="replaceable"><code>burn-in</code></em> C1.P<em class="replaceable"><code>p</code></em>.fastas | alignment-gild C1.P<em class="replaceable"><code>p</code></em>.max  &gt; P<em class="replaceable"><code>p</code></em>-max.AU
<code class="prompt">%</code> alignment-draw P<em class="replaceable"><code>p</code></em>-max.fasta --AU P<em class="replaceable"><code>p</code></em>-max.AU &gt; P<em class="replaceable"><code>p</code></em>-max-AU.html</pre></div></div><div class="sect2" title="7.4. Summarizing the output - scripted"><div class="titlepage"><div><div><h3 class="title"><a id="analysis"></a>7.4. Summarizing the output - scripted</h3></div></div></div><p>
      You may also run the analysis PERL script
      <span class="command"><strong>bp-analyze.pl</strong></span> inside the output directory in
      order to summary the output files.  
    </p><p>Running the above command will produce the following files in
    the <code class="filename">Results/</code> directory:</p><div class="variablelist"><table border="0"><col align="left" valign="top" /><tbody><tr><td><p><span class="term">analysis</span></p></td><td><p>A description of the analysis:  burn-in, length, time completed.
	</p></td></tr><tr><td><p><span class="term">Report</span></p></td><td><p>A summary of numerical parameters: credible
	    intervals and mixing.</p></td></tr><tr><td><p><span class="term">consensus</span></p></td><td><p>A summary of supported splits (clades). </p></td></tr><tr><td><p><span class="term">c-levels.plot</span></p></td><td><p>The number of splits (clades) supported at each LOD level.</p></td></tr><tr><td><p><span class="term">c50.tree</span></p></td><td><p>The majority consensus topology + branch lengths (Newick format)</p></td></tr><tr><td><p><span class="term">c50.PP.tree</span></p></td><td><p>The majority consensus topology + branch lengths +
	Posterior Probabilities (Newick format)</p></td></tr><tr><td><p><span class="term">MAP.tree</span></p></td><td><p>An estimate of the MAP topology + branch lengths (Newick format)</p></td></tr></tbody></table></div><p> 
	The following files will be generated to summarize alignment uncertainty, unless the analysis uses a fixed alignment.

      </p><div class="variablelist"><table border="0"><col align="left" valign="top" /><tbody><tr><td><p><span class="term">MAP.fasta</span></p></td><td><p>An estimate of the MAP alignment.
	</p></td></tr><tr><td><p><span class="term">P<em class="replaceable"><code>p</code></em>-max.fasta</span></p></td><td><p>An estimate of the alignment for partition
	    <em class="replaceable"><code>p</code></em> using posterior decoding.</p></td></tr><tr><td><p><span class="term">MAP-AU.html</span></p></td><td><p>An AU plot of the MAP alignment (AA/DNA color-cheme).
	</p></td></tr><tr><td><p><span class="term">P<em class="replaceable"><code>p</code></em>-max-AU.html</span></p></td><td><p>An AU plot of the posterior decoding alignment for partition
	    <em class="replaceable"><code>p</code></em>  (AA/DNA color-cheme).</p></td></tr></tbody></table></div><p>The following files describe convergence and mixing:</p><div class="variablelist"><table border="0"><col align="left" valign="top" /><tbody><tr><td><p><span class="term">partitions.bs</span></p></td><td><p>Confidence intervals on the support for partitions, generated
	      using a block bootstrap.</p></td></tr><tr><td><p><span class="term">partitions.SRQ</span></p></td><td><p>A collection of
	      SRQ plots for the supported partitions.
	</p></td></tr><tr><td><p><span class="term">c50.SRQ</span></p></td><td><p>An
	      SRQ plot for the majority consensus tree.
	</p></td></tr></tbody></table></div><p>The SRQ plots can be viewed by typing "<strong class="userinput"><code>plot
	  '<em class="replaceable"><code>file</code></em>' with lines</code></strong>" in
	<span class="application">gnuplot</span>.</p><div class="sect3" title="7.4.1. Mixing/partitions.bs: partition mixing"><div class="titlepage"><div><div><h4 class="title"><a id="id499504"></a>7.4.1. <code class="filename">Mixing/partitions.bs</code>: partition mixing</h4></div></div></div><p>
	  This file reports the quality of estimates of support for each
	  partition,in terms of the auto-correlation time (ACT),
	  effective sample size (Ne), and a 95% confidence interval for
	  posterior probability (PP) and log-10 odds (LOD).  It also
	  reports the number of samples that support (1) or do not
	  support (0) the partition, as well as the number of regenerations.

	  Only partitions with PP&gt;0.5 are shown by default.
	</p></div></div></div><div class="sect1" title="8. Models"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="models"></a>8. Models</h2></div></div></div><div class="sect2" title="8.1. Substitution models (Basic)"><div class="titlepage"><div><div><h3 class="title"><a id="subst_basic"></a>8.1. Substitution models (Basic)</h3></div></div></div><p>The basic substitution models in
	<span class="application">BAli-Phy</span> are continuous-time Markov
	chains (CTMC). More advanced models such as the <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>Γ</mml:mi> <mml:mn>4 </mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>INV</mml:mi></mml:math>
	model or the M2 codon model are described <a class="xref" href="#subst_adv" title="9. Substitution Models (Advanced)">Section 9, “Substitution Models (Advanced)”</a>. CTMC models can be characterized 
	by transition rates <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>Q</mml:mi> <mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub></mml:math> from letter <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>i</mml:mi></mml:math> to letter <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>j</mml:mi></mml:math>.
	After a given time <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>t</mml:mi></mml:math> the probability for transition from state
	<mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>i</mml:mi></mml:math> to state <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>j</mml:mi></mml:math> is given by </p><div class="equation"><a id="id499631"></a><p class="title"><b>Equation 0. </b></p><div class="equation-contents"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:msub><mml:mo>)</mml:mo> <mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:msub><mml:mi>Q</mml:mi> <mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:math></div></div><p><br class="equation-break" />
	using a matrix exponential.  Becase the The CTMC models used in
	<span class="application">BAli-Phy</span> are all reversible, the rate
	matrix for these reversible models can be decomposed into a
	symmetric matrix <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>S</mml:mi></mml:math> and equilibrium frequencies <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>π</mml:mi></mml:math> as
	follows:  </p><div class="equation"><a id="id499698"></a><p class="title"><b>Equation 0. </b></p><div class="equation-contents"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>Q</mml:mi> <mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>π</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:math></div></div><p><br class="equation-break" />
	The matrix <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>S</mml:mi></mml:math> is called the exchangability matrix, and
	represents how exchangeable letters <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>i</mml:mi></mml:math> and <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>j</mml:mi></mml:math> are
	independent of their frequencies.
      </p><div class="sect3" title="8.1.1. Basic CTMC models"><div class="titlepage"><div><div><h4 class="title"><a id="id499760"></a>8.1.1. Basic CTMC models</h4></div></div></div><p>The basic CTMC models are EQU, HKY, TN, GTR, HKYx3,
	  TNx3, GTRx3,  Empirical, and M0.  Each of these models is a
	  way of specifying the exchangeability matrix <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub></mml:math>.</p></div><div class="sect3" title="8.1.2. Default substitution models"><div class="titlepage"><div><div><h4 class="title"><a id="id499786"></a>8.1.2. Default substitution models</h4></div></div></div><p>If the substitution model is not specified, then the
	  default model for the alphabet is used.  For DNA or RNA, the
	  default model is HKY.  For Triplets, the default is HKYx3. For
          Codons, the default model is M0.  For Amino-Acids, the
	  default model is Empirical[WAG]. 
	</p></div><div class="sect3" title="8.1.3. Extended model descriptions"><div class="titlepage"><div><div><h4 class="title"><a id="id499799"></a>8.1.3. Extended model descriptions</h4></div></div></div><div class="table"><a id="id499804"></a><p class="title"><b>Table 1. Substitution Models</b></p><div class="table-contents"><table summary="Substitution Models" border="0"><colgroup><col /><col /><col /><col /></colgroup><thead><tr><th>Model</th><th>Alphabet</th><th>Parameters</th><th>Description</th></tr></thead><tbody><tr><td><strong class="userinput"><code>EQU</code></strong></td><td>any</td><td>none</td><td><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1 </mml:mn></mml:math> for every <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>i</mml:mi></mml:math> and <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>j</mml:mi></mml:math>.</td></tr><tr><td>
		  <p><strong class="userinput"><code>HKY</code></strong></p>
		  <p>Hasegawa, Kishino, Yano (1985)</p>
		</td><td>DNA or RNA</td><td><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>κ</mml:mi></mml:math>: the ts/tv ratio.</td><td>
		  <p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1 </mml:mn></mml:math> for transversions.</p>
		  <p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>κ</mml:mi></mml:math> for transitions.</p>
		</td></tr><tr><td><p><strong class="userinput"><code>TN</code></strong></p><p>Tamura, Nei (1993)</p></td><td>DNA or RNA</td><td>
		  <p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>κ</mml:mi> <mml:mn>1 </mml:mn></mml:msub></mml:math>: the purine ts/tv ratio.</p>
		  <p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>κ</mml:mi> <mml:mn>2 </mml:mn></mml:msub></mml:math>: the pyrimidine ts/tv ratio.</p>
		</td><td>
		  <p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1 </mml:mn></mml:math> for transversions.</p>
		  <p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>κ</mml:mi> <mml:mn>1 </mml:mn></mml:msub></mml:math> for purine transitions.</p>
		  <p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>κ</mml:mi> <mml:mn>2 </mml:mn></mml:msub></mml:math> for pyrimidine transitions.</p>
		</td></tr><tr><td><p><strong class="userinput"><code>GTR</code></strong></p><p>General Time-Reversible</p><p>Tavare (1986)</p></td><td>DNA or RNA</td><td>
		  <p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></p>
		</td><td>
		  <p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mo lspace="thinmathspace" rspace="thinmathspace">∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1 </mml:mn></mml:math>.</p><p>(5 degrees of freedom).</p>

		</td></tr><tr><td>
		  <p><strong class="userinput"><code>Empirical[WAG]</code></strong></p>
		  <p>Whelan and Goldman (2001)</p>
		</td><td>Amino-Acids</td><td>
		  <p>none.</p>
		</td><td> </td></tr><tr><td>
		  <p><strong class="userinput"><code>HKYx3</code></strong></p>
		  <p><strong class="userinput"><code>TNx3</code></strong></p>
		  <p><strong class="userinput"><code>GTRx3</code></strong></p>
		</td><td>Triplets</td><td>
		  <p><em class="replaceable"><code>nuc-model</code></em> parameters.</p>
		</td><td>
		  <p>If the nuc-model has transition matrix
		    <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msubsup><mml:mi>S</mml:mi> <mml:mrow><mml:mi>ij</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup></mml:math> on nucleotides, then:</p>

		  <p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>α</mml:mi><mml:mi>β</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0 </mml:mn></mml:math> for changes of more than one nucleotide.</p>
		  <p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>α</mml:mi><mml:mi>β</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>S</mml:mi> <mml:mrow><mml:mi>ij</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup></mml:math> for single nucleotide  changes <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi></mml:math>.</p>
		</td></tr><tr><td>
		  <p><strong class="userinput"><code>M0</code></strong></p>
		  <p>Nielsen and Yang (1998)</p>
		</td><td>Codons</td><td>
		  <p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>κ</mml:mi></mml:math>: the ts/tv ratio.</p>
		  <p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>ω</mml:mi></mml:math>: the dn/ds ratio.</p>
		</td><td>
		  <p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>α</mml:mi><mml:mi>β</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0 </mml:mn></mml:math> for changes of more than one nucleotide.</p>
		  <p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>α</mml:mi><mml:mi>β</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1 </mml:mn></mml:math> for synonymous transversions.</p>
		  <p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>α</mml:mi><mml:mi>β</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>ω</mml:mi></mml:math> for non-synonymous transversions.</p>

		  <p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>α</mml:mi><mml:mi>β</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>κ</mml:mi></mml:math> for synonymous transitions.</p>
		  <p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>α</mml:mi><mml:mi>β</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>ω</mml:mi><mml:mi>κ</mml:mi></mml:math> for non-synonymous transitions.</p>
		</td></tr><tr><td>
		  <p><strong class="userinput"><code>M0[<em class="replaceable"><code>nuc-model=HKY</code></em>]</code></strong></p>
		  <p>Nielsen and Yang (1998)</p>
		</td><td>Codons</td><td>
		  <p><em class="replaceable"><code>nuc-model</code></em> parameters.</p>
		  <p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>ω</mml:mi></mml:math>: the dn/ds ratio</p>
		</td><td>
		  <p>If the nuc-model has transition matrix
		    <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msubsup><mml:mi>S</mml:mi> <mml:mrow><mml:mi>ij</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup></mml:math> on nucleotides, then:</p>

		  <p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>α</mml:mi><mml:mi>β</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0 </mml:mn></mml:math> for changes of more than one nucleotide.</p>
		  <p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>α</mml:mi><mml:mi>β</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>S</mml:mi> <mml:mrow><mml:mi>ij</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup></mml:math> for synonymous changes.</p>
		  <p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>α</mml:mi><mml:mi>β</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>ω</mml:mi><mml:msubsup><mml:mi>S</mml:mi> <mml:mrow><mml:mi>ij</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup></mml:math> for non-synonymous changes.</p>
		</td></tr></tbody></table></div></div><br class="table-break" /></div></div><div class="sect2" title="8.2. Indel models"><div class="titlepage"><div><div><h3 class="title"><a id="id500682"></a>8.2. Indel models</h3></div></div></div><p>The current models are RS05, RS07-no-T, and RS07.  The default is RS07.</p></div><div class="sect2" title="8.3. Alignment constraints"><div class="titlepage"><div><div><h3 class="title"><a id="id500691"></a>8.3. Alignment constraints</h3></div></div></div><p>To pin columns of the alignment, specify alignment
	constraints in a file as follows: </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Use the argument
	    <strong class="userinput"><code>--align-constraint <em class="replaceable"><code>filename</code></em></code></strong></p></li><li class="listitem"><p>The filename refers to a file in which each
	    line represents a constraint.</p></li></ol></div><div class="sect3" title="8.3.1. Syntax"><div class="titlepage"><div><div><h4 class="title"><a id="id500722"></a>8.3.1. Syntax</h4></div></div></div><p>The first line of the file is a header consisting of an
	  ordered list of sequence names separated by spaces. Each subsequent line
	  consists of a space-separated list of sequence positions, with the first position
	  corresponding to the first leaf sequence, the second position
	  corresponding to the second leaf sequence, etc. Thus, if there are
	  <em class="replaceable"><code>n</code></em> leaf taxa, then each line corresponds to a
	  space-separated list of <em class="replaceable"><code>n</code></em> integers.</p></div><div class="sect3" title="8.3.2. Examples"><div class="titlepage"><div><div><h4 class="title"><a id="id500741"></a>8.3.2. Examples</h4></div></div></div><p>For example, the file</p><pre class="programlisting">A B C
1 2 2</pre><p>implies that position 1 of leaf sequence A is aligned to
	  position 2 of leaf sequences B and C. Note that the first
	  position in a sequence is position 0.</p><p>Optionally, one may use a '-' instead of an integer, which
	  denotes a lack of constraint for that sequence. This can be
	  useful as follows:</p><pre class="programlisting">A B C D
2 2 - - 
- - 2 2
	</pre><p>The above constraints force alignment between position 2
	  of sequences A and B, and between position 2 of sequence C and
	  D.</p></div><div class="sect3" title="8.3.3. Computing the constraints"><div class="titlepage"><div><div><h4 class="title"><a id="id500774"></a>8.3.3. Computing the constraints</h4></div></div></div><p>
	  The program <span class="command"><strong>alignment-indices</strong></span> may be used
	  to aid in computing a constraint file from an input
	  alignment.  See <a class="xref" href="#generating_constraint_files" title="13.5.3.">Q: 13.5.3</a>.
	</p></div></div></div><div class="sect1" title="9. Substitution Models (Advanced)"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="subst_adv"></a>9. Substitution Models (Advanced)</h2></div></div></div><p>
      Advanced substitution models in <span class="application">BAli-Phy</span>
      are constructed as mixtures of the basic CTMC models (see <a class="xref" href="#subst_basic" title="8.1. Substitution models (Basic)">Section 8.1, “Substitution models (Basic)”</a>) that run at different rates (e.g. <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>Γ</mml:mi> <mml:mn>4 </mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>INV</mml:mi></mml:math>)
      or parameters (e.g. an M2 codon model).
    </p><div class="sect2" title="9.1. Specifying a substitution model"><div class="titlepage"><div><div><h3 class="title"><a id="id500831"></a>9.1. Specifying a substitution model</h3></div></div></div><p>Substitution models are specified using a stack, as follows:
	<strong class="userinput"><code>Model[arg]+Model[arg]+...+Model[arg]</code></strong>
        where each model uses the previous models as input.  Arguments
	are optional.

	</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
	    If you are using the C-shell command line shell (<span class="command"><strong>csh</strong></span>), then it will try to interpret each argument as an array reference, giving the error message "bali-phy: Not found."  To avoid this you may need to insert backslashes before the left square brackes, like this: <strong class="userinput"><code>Model\[arg]+Model\[arg]+...+Model\[arg]</code></strong>.
	  </p></div><p>

      </p><p>Model modifiers are gamma, log-normal, INV, M2, M3, and M7.</p></div><div class="sect2" title="9.2. CTMC Frequency models"><div class="titlepage"><div><div><h3 class="title"><a id="id500869"></a>9.2. CTMC Frequency models</h3></div></div></div><p>The above decomposition can be generalized slightly to
	yield the following decomposition, where <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>f</mml:mi></mml:math> ranges from <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mn>0 </mml:mn></mml:math> to <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mn>1 </mml:mn></mml:math>.
	</p><div class="equation"><a id="id500899"></a><p class="title"><b>Equation 0. </b></p><div class="equation-contents"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>Q</mml:mi> <mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>π</mml:mi> <mml:mi>j</mml:mi> <mml:mi>f</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>π</mml:mi> <mml:mi>i</mml:mi> <mml:mrow><mml:mn>1 </mml:mn><mml:mo>-</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math></div></div><p><br class="equation-break" />
	Here the parameter <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>f</mml:mi></mml:math> specifies the relative importance of
	unequal conservation (<mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>0 </mml:mn></mml:math>) and unequal replacement (<mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1 </mml:mn></mml:math>) in
	maintaining the equilibrium frequencies <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>π</mml:mi></mml:math>.  
      </p><p>
	In fact, this can be generalized even further to </p><div class="equation"><a id="id500994"></a><p class="title"><b>Equation 0. </b></p><div class="equation-contents"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>Q</mml:mi> <mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mi>R</mml:mi><mml:mo>(</mml:mo><mml:mi>π</mml:mi><mml:msub><mml:mo>)</mml:mo> <mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub></mml:math></div></div><p><br class="equation-break" /> where </p><div class="equation"><a id="id501033"></a><p class="title"><b>Equation 0. </b></p><div class="equation-contents"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>π</mml:mi> <mml:mi>i</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>π</mml:mi> <mml:mi>j</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mi>ji</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:math></div></div><p><br class="equation-break" />
      </p><p>These models can therefore be expressed as a combination
	of an "exchange model" (for <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>S</mml:mi></mml:math>) and a "frequency model" (for
	<mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>R</mml:mi></mml:math>).
      </p></div><div class="sect2" title="9.3. Frequency Models"><div class="titlepage"><div><div><h3 class="title"><a id="id501095"></a>9.3. Frequency Models</h3></div></div></div><p>
      </p><div class="table"><a id="id501104"></a><p class="title"><b>Table 2. Frequency Models</b></p><div class="table-contents"><table summary="Frequency Models" border="0"><colgroup><col /><col /><col /><col /></colgroup><thead><tr><th>Model</th><th>Alphabet</th><th>Parameters</th><th>Description</th></tr></thead><tbody><tr><td>
		<p><strong class="userinput"><code>pi</code></strong></p>
		<p>Simple frequency model</p>
	      </td><td>any</td><td>
		<p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>f</mml:mi></mml:math> (1)</p>
		<p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>π</mml:mi></mml:math> (<mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mo lspace="0em" rspace="0em">∣</mml:mo><mml:mi>α</mml:mi><mml:mo lspace="0em" rspace="0em">∣</mml:mo></mml:math>) </p>
	      </td><td><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>π</mml:mi> <mml:mi>j</mml:mi> <mml:mi>f</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>π</mml:mi> <mml:mi>i</mml:mi> <mml:mrow><mml:mn>1 </mml:mn><mml:mo>-</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:math>.</td></tr><tr><td>
		<p><strong class="userinput"><code>pi=nucleotides</code></strong></p>
		<p>Independent nucleotide frequency model</p>
	      </td><td>Triplets</td><td>
		<p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>f</mml:mi></mml:math> (1)</p>
		<p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>π</mml:mi> <mml:mi>N</mml:mi></mml:msub></mml:math> (4) </p>
	      </td><td>
		<p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>π</mml:mi> <mml:mi>α</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>π</mml:mi> <mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>π</mml:mi> <mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>π</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:math></p>
		<p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mi>α</mml:mi><mml:mi>β</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>π</mml:mi> <mml:mi>β</mml:mi> <mml:mi>f</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>π</mml:mi> <mml:mi>α</mml:mi> <mml:mrow><mml:mn>1 </mml:mn><mml:mo>-</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:math>.</p>
	      </td></tr><tr><td>
		<p><strong class="userinput"><code>pi=amino-acids</code></strong></p>
		<p>Amino-acid based codon frequencies. (no codon bias)</p>
	      </td><td>Codons</td><td>
		<p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>f</mml:mi></mml:math> (1)</p>
		<p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>π</mml:mi> <mml:mrow><mml:mi>AA</mml:mi></mml:mrow></mml:msub></mml:math> (20)</p>
	      </td><td><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>π</mml:mi> <mml:mi>j</mml:mi> <mml:mi>f</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>π</mml:mi> <mml:mi>i</mml:mi> <mml:mrow><mml:mn>1 </mml:mn><mml:mo>-</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:math>.</td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2" title="9.4. CTMC Mixture Models"><div class="titlepage"><div><div><h3 class="title"><a id="id501528"></a>9.4. CTMC Mixture Models</h3></div></div></div><div class="table"><a id="id501541"></a><p class="title"><b>Table 3. Extended Model Descriptions</b></p><div class="table-contents"><table summary="Extended Model Descriptions" border="0"><colgroup><col /><col /><col /><col /></colgroup><tbody><tr><td>
		<p><strong class="userinput"><code><em class="replaceable"><code>sm</code></em> + INV</code></strong></p>
	      </td><td><em class="replaceable"><code>sm</code></em> alphabet</td><td>
		<p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>p</mml:mi></mml:math>: invariant fraction.</p>
	      </td><td>
		<p>A fraction <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>p</mml:mi></mml:math> of sites do not allow substitutions.</p>
	      </td></tr><tr><td>
		<p><strong class="userinput"><code><em class="replaceable"><code>sm</code></em> + gamma[<mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>n</mml:mi></mml:math>]</code></strong></p>
		<p>Yang (1994)</p>
	      </td><td><em class="replaceable"><code>sm</code></em> alphabet</td><td>
		<p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>σ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:math>: noise to signal ratio for <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>Γ</mml:mi></mml:math>.</p>
	      </td><td>
		<p>rate <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mo>∼</mml:mo><mml:mi>Γ</mml:mi><mml:mo>(</mml:mo><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1 </mml:mn><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>)</mml:mo></mml:math>.</p>
		<p>A discrete approximation to the <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>Γ</mml:mi></mml:math> with <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>n</mml:mi></mml:math>
     	          bins is used.</p>
	      </td></tr><tr><td>
		<p><strong class="userinput"><code><em class="replaceable"><code>sm</code></em> + log-normal[<mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>n</mml:mi></mml:math>]</code></strong></p>
	      </td><td><em class="replaceable"><code>sm</code></em> alphabet</td><td>
		<p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>σ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:math>: noise to signal ratio for <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>log</mml:mi><mml:mi>Normal</mml:mi></mml:math>.</p>
	      </td><td>
		<p>rate <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mo>∼</mml:mo><mml:mi>log</mml:mi><mml:mi>Normal</mml:mi><mml:mo>(</mml:mo><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1 </mml:mn><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>)</mml:mo></mml:math>.</p>
		<p>A discrete approximation to the <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>log</mml:mi><mml:mi>Normal</mml:mi></mml:math> with <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>n</mml:mi></mml:math>
     	          bins is used.</p>
	      </td></tr><tr><td>
		<p><strong class="userinput"><code>M2</code></strong></p>
		<p><strong class="userinput"><code><em class="replaceable"><code>sm</code></em> + M2</code></strong></p>
		<p>Yang, et. al. (2000)</p>
	      </td><td>Codons</td><td>
		<p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>κ</mml:mi></mml:math>: the ts/tv ratio</p>
		<p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>p</mml:mi> <mml:mn>1 </mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi> <mml:mn>2 </mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi> <mml:mn>3 </mml:mn></mml:msub></mml:math>: bin frequencies.</p>
		<p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>ω</mml:mi> <mml:mn>3 </mml:mn></mml:msub></mml:math>: value of <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>ω</mml:mi></mml:math> in bin 2.</p>
	      </td><td>
		<p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>Ω</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>ω</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:math> with probability <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>p</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:math>.</p>
		<p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>ω</mml:mi> <mml:mn>1 </mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0 </mml:mn></mml:math>, <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>ω</mml:mi> <mml:mn>2 </mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1 </mml:mn></mml:math>.</p>
		<p>The default for <em class="replaceable"><code>sm</code></em> is M0.</p>
	      </td></tr><tr><td>
		<p><strong class="userinput"><code>M3[<mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>n</mml:mi></mml:math>]</code></strong></p>
		<p><strong class="userinput"><code><em class="replaceable"><code>sm</code></em> + M3[<mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>n</mml:mi></mml:math>]</code></strong></p>
		<p>Yang, et. al. (2000)</p>
	      </td><td>Codons</td><td>
		<p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>κ</mml:mi></mml:math>: the ts/tv ratio</p>
		<p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>p</mml:mi> <mml:mn>1 </mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi> <mml:mi>n</mml:mi></mml:msub></mml:math>: bin frequencies.</p>
		<p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>ω</mml:mi> <mml:mn>1 </mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ω</mml:mi> <mml:mi>n</mml:mi></mml:msub></mml:math>: values of <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>ω</mml:mi></mml:math>.</p>
	      </td><td>
		<p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>Ω</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>ω</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:math> with probability <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:msub><mml:mi>p</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:math>.</p>
	      </td></tr><tr><td>
		<p><strong class="userinput"><code>M7[<mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>n</mml:mi></mml:math>]</code></strong></p>
		<p><strong class="userinput"><code><em class="replaceable"><code>sm</code></em> + M7[<mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>n</mml:mi></mml:math>]</code></strong></p>
		<p>Yang, et. al. (2000)</p>
	      </td><td>Codons</td><td>
		<p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>μ</mml:mi></mml:math>: mean of the Beta distribution.</p>
		<p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>σ</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi></mml:math>: noise to signal ratio for Beta.</p>
	      </td><td>
		<p><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>Ω</mml:mi><mml:mo>∼</mml:mo><mml:mi>Beta</mml:mi><mml:mo>(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>)</mml:mo></mml:math>.</p>
		<p>A discrete approximation to the Beta with <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" overflow="scroll"><mml:mi>n</mml:mi></mml:math>
     	          bins is used.</p>
	      </td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2" title="9.5. Examples"><div class="titlepage"><div><div><h3 class="title"><a id="id502272"></a>9.5. Examples</h3></div></div></div><p>Example: --smodel EQU --alphabet Triplets</p><p>Example: --smodel HKY</p><p>Example: --smodel TN+pi=constant</p><p>Example: --smodel Empirical[WAG]+log-normal+INV</p><p>Example: --smodel M0 --alphabet Codons</p><p>Example: --smodel M0+pi=nucleotides --alphabet Codons</p><p>Example: --smodel M2 --alphabet Codons</p><p>Example: --smodel M0[TN]+M2 --alphabet Codons</p></div></div><div class="sect1" title="10. Convergence and Mixing: Is it done yet?"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="mixing_and_convergence"></a>10. Convergence and Mixing: Is it done yet?</h2></div></div></div><p>
      When using Markov chain Monte Carlo (MCMC) programs like
      <span class="application">MrBayes</span>, <span class="application">BEAST</span> or
      <span class="application">BAli-Phy</span>, one of the key questions is
      how many iterations are required to give a good estimate.
      Unfortunately, this question is complicated and depends upon
      both the problem and the specific data set that is being
      examined.  As a result, <span class="application">BAli-Phy</span>
      relies on the user to determine when enough samples have been
      obtained - and to terminate the program when this happens. 
    </p><p>
      In general, we recommend that you analyze the data from a
      running chain periodically and repeatedly in order to determine
      when to stop it.
    </p><p>
      To inspect the Markov chain generated by
      <span class="application">BAli-Phy</span>, we recommend the program
      <a class="ulink" href="http://evolve.zoo.ox.ac.uk/software/tracer/" target="_top">Tracer</a>. 
      You can open the file <code class="filename">C1.p</code> in Tracer to view
      traceplots and to estimate the effective sample size.  However,
      these techniques that work well for numerical parameters do not
      work well for objects such as trees and alignments.  Therefore,
      the full analysis is necessary as well (<a class="xref" href="#analysis" title="7.4. Summarizing the output - scripted">Section 7.4, “Summarizing the output - scripted”</a>).
    </p><div class="sect2" title="10.1. Convergence"><div class="titlepage"><div><div><h3 class="title"><a id="id502370"></a>10.1. Convergence</h3></div></div></div><div class="sect3" title="10.1.1. Definition"><div class="titlepage"><div><div><h4 class="title"><a id="id502375"></a>10.1.1. Definition</h4></div></div></div><p>
	  What is convergence, and how can you check if a Markov chain
	  has "converged"?  We first note that "convergence" refers to
	  the tendency of a Markov chain to converge to the desired
	  distribution (its equilibrium distribution).  The Markov chain starts at a
	  specific tree and alignment, which may not be representative
	  of the equilibrium distribution, and so convergence
	  represents the process of "forgetting" the starting value.
	  If we represent the i-th iteration of the Markov chain as
	  X[i], then we desire rapid convergence of the distribution
	  of X[i] to the equilibrium distribution.
	</p></div><div class="sect3" title="10.1.2. Burn-in"><div class="titlepage"><div><div><h4 class="title"><a id="id502390"></a>10.1.2. Burn-in</h4></div></div></div><p>
	  In practice, most MCMC analyses designate some number of
	  samples at the beginning of each chain as "burn-in".  These
	  samples are discarded because they represent the initial
	  starting point, but not the equilibrium distribution.
	</p><p>
	  Determining the number of samples to discard as burn-in is
	  usually rather ad-hoc.  MCMC practitioners often run the
	  chain for a "long" time, and then visually inspect the
	  samples, perhaps using <a class="ulink" href="http://evolve.zoo.ox.ac.uk/software/tracer/" target="_top">Tracer</a>. After some number of iterations, the 
	  samples become "typical" of later values, and that number
	  is chosen as the burn-in.  Unfortunately, it is always
	  possible that if you run the Markov chain even longer, then
	  the values will change again.  Therefore, this method is not
	  strong evidence that a chain converges before a given burn-in time.
	</p></div><div class="sect3" title="10.1.3. Testing Convergence"><div class="titlepage"><div><div><h4 class="title"><a id="id502415"></a>10.1.3. Testing Convergence</h4></div></div></div><p>
	  A better (but not perfect) test of convergence is to run
	  several independent chains starting from many different
	  places.  It is possible that each Markov chain will get
	  stuck in local optima near its own starting value, but that
	  the movement between the different local optima will be
	  exceedingly slow.  However, if the posterior distributions
	  from each Markov chain seem to be the same, then that gives some
	  evidence that the MCMC procedure is truly converging to a
	  global equilibrium.
	</p></div></div><div class="sect2" title="10.2. Mixing"><div class="titlepage"><div><div><h3 class="title"><a id="id502430"></a>10.2. Mixing</h3></div></div></div><div class="sect3" title="10.2.1. Definition"><div class="titlepage"><div><div><h4 class="title"><a id="id502436"></a>10.2.1. Definition</h4></div></div></div><p>
	  In MCMC, each sample is not fully independent of previous
	  samples.  In fact, a Markov chain can get "stuck" in one part
	  of the parameter space for a long time, before jumping to an
	  equally important part.  When this happens, we say that the
	  chain isn't "mixing" well.
	</p></div><div class="sect3" title="10.2.2. Measures: how good is the mixing?"><div class="titlepage"><div><div><h4 class="title"><a id="id502448"></a>10.2.2. Measures: how good is the mixing?</h4></div></div></div><p>
	  For continuous parameters, one common measure is the
	  effective sample size (ESS).  Given a collection of
	  <span class="emphasis"><em>dependent</em></span> samples from a Markov chain,
	  the effective sample size is the equivalent number of
	  <span class="emphasis"><em>independent</em></span> samples.  However, there
	  are many ways one could measure "equivalence".  The usual
	  way is to compare samples based on the variance of the sum
	  of the values.
	</p></div></div></div><div class="sect1" title="11. Tuning the Markov Chain"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="tuning_the_markov_chain"></a>11. Tuning the Markov Chain</h2></div></div></div><p>The Markov chain should be largely self-tuning, since all
    numerical parameters are now sampled using slice samplers.  However,
    the following parameters affect the size of Metropolis-Hastings
    proposals.  You can modify them using the command line syntax "<strong class="userinput"><code>--set <em class="replaceable"><code>parameter</code></em>=<em class="replaceable"><code>value</code></em></code></strong>".</p><div class="sect2" title="11.1. Parameters"><div class="titlepage"><div><div><h3 class="title"><a id="id502493"></a>11.1. Parameters</h3></div></div></div><p>

	</p><div class="table"><a id="id502500"></a><p class="title"><b>Table 4. Tunable Parameters</b></p><div class="table-contents"><table summary="Tunable Parameters" border="0"><colgroup><col /><col /><col /><col /></colgroup><thead><tr><th>Name</th><th>Variable</th><th>Default</th><th>Meaning</th></tr></thead><tbody><tr><td>log_branch_sigma</td><td>branch lengths</td><td>0.6</td><td>Scale of log-proposal.</td></tr><tr><td>branch_sigma</td><td>branch lengths</td><td>0.6</td><td>Scale of non-log-proposal.</td></tr><tr><td>mu_scale_sigma</td><td>mu</td><td>0.6</td><td>Width of proposal on log scale.</td></tr><tr><td>kappa_scale_sigma</td><td>HKY::kappa, TN::kappa(pur), TN::kappa(pyr)</td><td>0.3</td><td>Width of proposal on log scale.</td></tr><tr><td>omega_scale_sigma</td><td>M0::omega, M2::omega</td><td>0.3</td><td>Width of proposal on log scale.</td></tr><tr><td>beta::mu_scale_sigma</td><td>beta::mu</td><td>0.2</td><td>Width of proposal.</td></tr><tr><td>INV::p_shift_sigma</td><td>INV::p</td><td>0.03</td><td>Width of proposal.</td></tr><tr><td>gamma::sigma_scale_sigma</td><td>gamma::sigma/mu</td><td>0.25</td><td>Width of proposal of log scale.</td></tr><tr><td>pi_dirichlet_N</td><td>pi*</td><td>1.0</td><td>Tightness of dirichlet proposal for frequencies.</td></tr><tr><td>lambda_shift_sigma</td><td>delta, lambda</td><td>0.35</td><td>Width of proposal.</td></tr><tr><td>epsilon_shift_sigma</td><td>epsilon</td><td>0.15</td><td>Width of proposal.</td></tr></tbody></table></div></div><p><br class="table-break" />
      </p></div></div><div class="sect1" title="12. Auxiliary tools"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="auxiliary_tools"></a>12. Auxiliary tools</h2></div></div></div><p>Most of these tools will describe their options if given the "<strong class="userinput"><code>--help</code></strong>" argument on the command line.</p><div class="sect2" title="12.1. alignment-find"><div class="titlepage"><div><div><h3 class="title"><a id="id502764"></a>12.1. alignment-find</h3></div></div></div><p>Usage: alignment-find [OPTIONS] &lt; <em class="replaceable"><code>alignments-file</code></em></p><p>Find the last (or first) FastA alignment in a file.</p></div><div class="sect2" title="12.2. alignment-draw"><div class="titlepage"><div><div><h3 class="title"><a id="id502779"></a>12.2. alignment-draw</h3></div></div></div><p>alignment-draw <em class="replaceable"><code>alignment-file</code></em> [<em class="replaceable"><code>AU-file</code></em>] [OPTIONS]</p><p>Draw an alignment to HTML, optionally coloring residues by AU.</p></div><div class="sect2" title="12.3. alignment-thin"><div class="titlepage"><div><div><h3 class="title"><a id="id502798"></a>12.3. alignment-thin</h3></div></div></div><p>alignment-thin <em class="replaceable"><code>alignment-file</code></em> <em class="replaceable"><code>tree-file</code></em> [OPTIONS]</p><p>Remove taxa from an alignment to preserve the most
	sequence diversity, as measured by the  total length of the tree
	for the remaining taxa.</p></div><div class="sect2" title="12.4. alignment-chop-internal"><div class="titlepage"><div><div><h3 class="title"><a id="id502818"></a>12.4. alignment-chop-internal</h3></div></div></div><p>alignment-chop-internal <em class="replaceable"><code>alignment-file</code></em> [OPTIONS]</p><p>Remove ancestral sequences from an alignment.  (This
	probably only works for alignments output by bali-phy.) </p></div><div class="sect2" title="12.5. alignment-info"><div class="titlepage"><div><div><h3 class="title"><a id="id502836"></a>12.5. alignment-info</h3></div></div></div><p>alignment-info <em class="replaceable"><code>alignment-file</code></em> <em class="replaceable"><code>tree-file</code></em> [OPTIONS]</p><p>Display basic information about the alignment, including
	its length, the number of sequences, columns that are constant
	or informative, letter frequencies, etc.</p><p>If a tree is supplied, then the unweighted parsimony score
	is given as well.</p></div><div class="sect2" title="12.6. alignment-indices"><div class="titlepage"><div><div><h3 class="title"><a id="id502859"></a>12.6. alignment-indices</h3></div></div></div><p>alignment-indices <em class="replaceable"><code>alignment-file</code></em> [OPTIONS]</p><p>Show the alignment in terms of the index of each character
	in its sequence.  Each line in this file corresponds to one
	alignment column.  This can be useful in producing alignment
	constraint files.</p><p>Also, you can specify which columns to keep using the
	--columns option.
      </p></div><div class="sect2" title="12.7. alignment-cat"><div class="titlepage"><div><div><h3 class="title"><a id="id502880"></a>12.7. alignment-cat</h3></div></div></div><p>alignment-cat <em class="replaceable"><code>file1</code></em>
	[<em class="replaceable"><code>file2</code></em> ...]</p><p>Concatenate several alignments (with the same sequence
	names) end-to-end.</p></div><div class="sect2" title="12.8. trees-consensus"><div class="titlepage"><div><div><h3 class="title"><a id="id502900"></a>12.8. trees-consensus</h3></div></div></div><p>Usage: trees-consensus <em class="replaceable"><code>file</code></em>
	[OPTIONS] </p><p>This program analyzes the tree sample contained in
	<em class="replaceable"><code>file</code></em>.  It reports the MAP topology, the
	supported taxa partitions (including partial partitions), and the
	majority consensus topology.
      </p></div><div class="sect2" title="12.9. trees-bootstrap"><div class="titlepage"><div><div><h3 class="title"><a id="id502920"></a>12.9. trees-bootstrap</h3></div></div></div><p>Usage: trees-bootstrap <em class="replaceable"><code>file1</code></em>
	[<em class="replaceable"><code>file2</code></em> ... ] --predicates
	<em class="replaceable"><code>predicate-file</code></em> [OPTIONS] </p><p>This program analyzes the tree samples contained in
	<em class="replaceable"><code>file1</code></em>, <em class="replaceable"><code>file2</code></em>,
	etc.  It gives the support of each tree sample for each predicate in
	<em class="replaceable"><code>predicate-file</code></em>, and reports a confidence
	interval based on the block bootstrap.
      </p><p>Each predicate is the intersection of a set of partitions, and
	is specified as a list of partitions or (multifurcating) trees, one
	per line.  Predicates are separated by blank lines.
      </p></div><div class="sect2" title="12.10. trees-to-SRQ"><div class="titlepage"><div><div><h3 class="title"><a id="id502959"></a>12.10. trees-to-SRQ</h3></div></div></div><p>Usage: trees-to-SRQ <em class="replaceable"><code>predicate-file</code></em> [OPTIONS] <em class="replaceable"><code>trees-file</code></em> </p><p>This program analyzes the tree samples contained in
	<em class="replaceable"><code>trees-file</code></em>.  It uses them to produce an
	SRQ plot for each predicate in
	<em class="replaceable"><code>predicate-file</code></em>.  Plots are produced in
	<span class="application">gnuplot</span> format, with one point per line
	and with plots separated by a blank line.</p><p>If <strong class="userinput"><code>--mode sum </code></strong> is specified, then a "sum"
	plot is produced instead of an SRQ plot.  In this plot, the slope of
	the curve corresponds to the posterior probability of the event.  If the
	<strong class="userinput"><code>--invert</code></strong> option is used then the slope of the
	curve correspond to the probability of the inverse event.  This is
	recommended if the probability of the event is near 1.0, because the
	sum plot does not distinguish variation in probabilities near 1.0 well.
      </p></div></div><div class="sect1" title="13. Frequently Asked Questions (FAQ)"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="FAQ"></a>13. Frequently Asked Questions (FAQ)</h2></div></div></div><div class="sect2" title="13.1. Running bali-phy."><div class="titlepage"><div><div><h3 class="title"><a id="id503016"></a>13.1. Running <span class="command"><strong>bali-phy</strong></span>.</h3></div></div></div><div class="qandaset" title="Frequently Asked Questions"><a id="id503027"></a><dl><dt>13.1.1. <a href="#id503029">Can I fix the alignment?</a></dt></dl><table border="0" width="100%" summary="Q and A Set"><col align="left" width="1%" /><col /><tbody><tr class="question" title="13.1.1."><td align="left" valign="top"><a id="id503029"></a><a id="id503031"></a><p><b>13.1.1.</b></p></td><td align="left" valign="top"><p>Can I fix the alignment?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Yes.  Add <strong class="userinput"><code>-t</code></strong> or <strong class="userinput"><code>--traditional</code></strong> on the command line.</p></td></tr></tbody></table></div></div><div class="sect2" title="13.2. Figuring out run-time errors"><div class="titlepage"><div><div><h3 class="title"><a id="id503055"></a>13.2. Figuring out run-time errors</h3></div></div></div><div class="qandaset" title="Frequently Asked Questions"><a id="id503061"></a><dl><dt>13.2.1. <a href="#id503063">I tried to use --smodel gamma[6] and I got an error message "bali-phy: No match."  What gives?</a></dt></dl><table border="0" width="100%" summary="Q and A Set"><col align="left" width="1%" /><col /><tbody><tr class="question" title="13.2.1."><td align="left" valign="top"><a id="id503063"></a><a id="id503065"></a><p><b>13.2.1.</b></p></td><td align="left" valign="top"><p>I tried to use <strong class="userinput"><code>--smodel gamma[6]</code></strong> and I got an error message "bali-phy: No match."  What gives?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>You are probably using the C-shell as your command line shell.  It is trying to interpret <strong class="userinput"><code>gamma[6]</code></strong> as an array before running the command, and it is not succeeding.  Therefore, it doesn't even run <span class="command"><strong>bali-phy</strong></span>.</p><p>To avoid this, put a backslash in front of the first "[" and write <strong class="userinput"><code>--smodel gamma\[6]</code></strong>.  This will keep the C-shell from interfering with your command.
	    </p></td></tr></tbody></table></div></div><div class="sect2" title="13.3. Stopping bali-phy."><div class="titlepage"><div><div><h3 class="title"><a id="id503105"></a>13.3. Stopping <span class="command"><strong>bali-phy</strong></span>.</h3></div></div></div><div class="qandaset" title="Frequently Asked Questions"><a id="id503116"></a><dl><dt>13.3.1. <a href="#id503118">Why is bali-phy still
	      running? How long will it take?</a></dt><dt>13.3.2. <a href="#id503138">So, how can I know when to stop it?</a></dt><dt>13.3.3. <a href="#id503153">How can you tell when the chain has converged?</a></dt><dt>13.3.4. <a href="#id503177">How can I check how many iterations the chain
	      has finished?</a></dt></dl><table border="0" width="100%" summary="Q and A Set"><col align="left" width="1%" /><col /><tbody><tr class="question" title="13.3.1."><td align="left" valign="top"><a id="id503118"></a><a id="id503120"></a><p><b>13.3.1.</b></p></td><td align="left" valign="top"><p>Why is <span class="command"><strong>bali-phy</strong></span> still
	      running? How long will it take?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>It runs until you stop it.  Stop it when its
	      done.</p></td></tr><tr class="question" title="13.3.2."><td align="left" valign="top"><a id="id503138"></a><a id="id503140"></a><p><b>13.3.2.</b></p></td><td align="left" valign="top"><p>So, how can I know when to stop it?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>You can stop when it has both converged and also run for long enough to give
	      you &gt;1000 effectively independent samples.  </p></td></tr><tr class="question" title="13.3.3."><td align="left" valign="top"><a id="id503153"></a><a id="id503155"></a><p><b>13.3.3.</b></p></td><td align="left" valign="top"><p>How can you tell when the chain has converged?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>It depends on the data set.  To test convergence, run at
	      least 4 independent chains (preferably 10) from different
	      random starting points and see if the posterior
	      distributions for each chain are the same. 
	    </p><p>Unfortunately, when the distributions all seem to be this same, this doesn't <span class="emphasis"><em>prove</em></span> that they have all converged to the equilibrium distribution.  However, if the distributions are different then you can reject either convergence or good mixing. </p></td></tr><tr class="question" title="13.3.4."><td align="left" valign="top"><a id="id503177"></a><a id="id503180"></a><p><b>13.3.4.</b></p></td><td align="left" valign="top"><p>How can I check how many iterations the chain
	      has finished?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Run <span class="command"><strong>wc -l C1.p</strong></span> inside the output
	      directory, and subtract 2.
	    </p></td></tr></tbody></table></div></div><div class="sect2" title="13.4. Interpreting the results."><div class="titlepage"><div><div><h3 class="title"><a id="id503200"></a>13.4. Interpreting the results.</h3></div></div></div><div class="qandaset" title="Frequently Asked Questions"><a id="id503205"></a><dl><dt>13.4.1. <a href="#id503207">Where can I find the clade support?</a></dt><dt>13.4.2. <a href="#id503223">Where can I find the partition support?</a></dt></dl><table border="0" width="100%" summary="Q and A Set"><col align="left" width="1%" /><col /><tbody><tr class="question" title="13.4.1."><td align="left" valign="top"><a id="id503207"></a><a id="id503210"></a><p><b>13.4.1.</b></p></td><td align="left" valign="top"><p>Where can I find the clade support?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Actually, BAli-Phy uses unrooted trees, so it only estimates bi-partition support.  A bi-partition is a division of taxa into two groups, but it does not specify which group contains the root. </p></td></tr><tr class="question" title="13.4.2."><td align="left" valign="top"><a id="id503223"></a><a id="id503225"></a><p><b>13.4.2.</b></p></td><td align="left" valign="top"><p>Where can I find the partition support?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>After you analyze the output (<a class="xref" href="#analysis" title="7.4. Summarizing the output - scripted">Section 7.4, “Summarizing the output - scripted”</a>), the partition support is indicated in
	      <code class="filename">Results/consensus</code> and in <code class="filename">Results/c50.PP.tree</code>. </p></td></tr></tbody></table></div></div><div class="sect2" title="13.5. How do I..."><div class="titlepage"><div><div><h3 class="title"><a id="id503254"></a>13.5. How do I...</h3></div></div></div><div class="qandaset" title="Frequently Asked Questions"><a id="id503259"></a><dl><dt>13.5.1. <a href="#id503261">How do I concatenate alignments?</a></dt><dt>13.5.2. <a href="#id503291">How do I select columns from an alignment?</a></dt><dt>13.5.3. <a href="#id503317">How do I create an alignment-constraint file
	      from an alignment?</a></dt></dl><table border="0" width="100%" summary="Q and A Set"><col align="left" width="1%" /><col /><tbody><tr class="question" title="13.5.1."><td align="left" valign="top"><a id="id503261"></a><a id="id503263"></a><p><b>13.5.1.</b></p></td><td align="left" valign="top"><p>How do I concatenate alignments?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
 	    </p><pre class="screen"><code class="prompt">%</code>alignment-cat <em class="replaceable"><code>filename1.fasta</code></em> <em class="replaceable"><code>filename2.fasta</code></em> &gt; result.fasta</pre><p>
	      The alignments must have the same sequence names, but
	      not necessarily in the same order.
	    </p></td></tr><tr class="question" title="13.5.2."><td align="left" valign="top"><a id="id503291"></a><a id="id503293"></a><p><b>13.5.2.</b></p></td><td align="left" valign="top"><p>How do I select columns from an alignment?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
	    </p><pre class="screen"><code class="prompt">%</code>alignment-cat -c1-10,50-100,600- <em class="replaceable"><code>filename.fasta</code></em> &gt; result.fasta</pre><p>
	    The resulting alignment will contain the selected columns
	    in the order you specified.
	  </p></td></tr><tr class="question" title="13.5.3."><td align="left" valign="top"><a id="id503317"></a><a id="generating_constraint_files"></a><p><b>13.5.3.</b></p></td><td align="left" valign="top"><p>How do I create an alignment-constraint file
	      from an alignment?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>To constrain the alignment to match some alignment
	      file <em class="replaceable"><code>filename.fasta</code></em> in columns
	      100, 200-250, and 300, run:
	      </p><pre class="screen"><code class="prompt">%</code>alignment-indices -c100,200-250,300 <em class="replaceable"><code>filename.fasta</code></em> &gt; filename.constraint</pre><p>
	    </p></td></tr></tbody></table></div></div></div></div></body></html>
